<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RabbitMQ | CV大魔王的笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://gzfhsw.oss-cn-guangzhou.aliyuncs.com/typora/2022/07/logo.png">
    <meta name="description" content="技术类笔记，在往全栈的路上努力奋斗，主攻java，擅长微服务。前端方面熟悉vue3，ts，uniapp，原生安卓。对设计模式有所了解，正在恶补数据结构和算法">
    
    <link rel="preload" href="/assets/css/0.styles.3b9c3e1f.css" as="style"><link rel="preload" href="/assets/js/app.207d8edd.js" as="script"><link rel="preload" href="/assets/js/2.02d677e7.js" as="script"><link rel="preload" href="/assets/js/7.4b00f606.js" as="script"><link rel="prefetch" href="/assets/js/10.d667f1d4.js"><link rel="prefetch" href="/assets/js/3.58e6395d.js"><link rel="prefetch" href="/assets/js/4.0f51aaa2.js"><link rel="prefetch" href="/assets/js/5.1ac8b83b.js"><link rel="prefetch" href="/assets/js/6.25b5a53a.js"><link rel="prefetch" href="/assets/js/8.971d2875.js"><link rel="prefetch" href="/assets/js/9.5c75629e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.3b9c3e1f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://gzfhsw.oss-cn-guangzhou.aliyuncs.com/typora/2022/07/logo.png" alt="CV大魔王的笔记" class="logo"> <span class="site-name">CV大魔王的笔记</span></a> <nav class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <ul class="nav-links can-hide"><li class="nav-item"><a href="/" class="nav-link"><!----> <span>首页</span></a></li><li class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title">
      Java
    </span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><!----> <span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端开发/通用/java增效系列.html" class="nav-link"><!----> <span>后端开发(Java)</span></a></li><li class="dropdown-item"><!----> <a href="/后端开发/Redis/" class="nav-link"><!----> <span>Redis专栏</span></a></li></ul></div></li><li class="nav-item"><a href="/前端开发/" class="nav-link"><!----> <span>前端开发</span></a></li><li class="nav-item"><a href="/数据库/" class="nav-link"><!----> <span>数据库</span></a></li><li class="nav-item"><a href="/微服务专栏/" class="nav-link"><!----> <span>微服务专栏</span></a></li><li class="nav-item"><a href="/插件开发/" class="nav-link"><!----> <span>插件开发</span></a></li><li class="nav-item"><a href="/Spring专栏/" class="nav-link"><!----> <span>Spring专栏</span></a></li> <!----></ul> <div class="theme-switcher"><a class="switch light"><span><i aria-hidden="true" class="fa fa-sun"></i></span></a></div></nav></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!----> <ul class="nav-links"><li class="nav-item"><a href="/" class="nav-link"><!----> <span>首页</span></a></li><li class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title">
      Java
    </span> <span class="arrow down"></span></button> <button type="button" aria-label="Java" class="mobile-dropdown-title"><!----> <span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端开发/通用/java增效系列.html" class="nav-link"><!----> <span>后端开发(Java)</span></a></li><li class="dropdown-item"><!----> <a href="/后端开发/Redis/" class="nav-link"><!----> <span>Redis专栏</span></a></li></ul></div></li><li class="nav-item"><a href="/前端开发/" class="nav-link"><!----> <span>前端开发</span></a></li><li class="nav-item"><a href="/数据库/" class="nav-link"><!----> <span>数据库</span></a></li><li class="nav-item"><a href="/微服务专栏/" class="nav-link"><!----> <span>微服务专栏</span></a></li><li class="nav-item"><a href="/插件开发/" class="nav-link"><!----> <span>插件开发</span></a></li><li class="nav-item"><a href="/Spring专栏/" class="nav-link"><!----> <span>Spring专栏</span></a></li> <!----></ul>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><i></i> <span>后端开发(Java)</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/后端开发/通用/java增效系列.html" class="sidebar-link">java高效编程常用技术优化手段</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端开发/通用/java增效系列.html#资源关闭优化方案" class="sidebar-link">资源关闭优化方案</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/java增效系列.html#jdk8新特性optional使用详解" class="sidebar-link">JDK8新特性Optional使用详解</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/java增效系列.html#拯救垃圾代码使用guava工具类" class="sidebar-link">拯救垃圾代码使用Guava工具类</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/java增效系列.html#multiset可重复无序集合" class="sidebar-link">Multiset可重复无序集合</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/java增效系列.html#集合工具类" class="sidebar-link">集合工具类</a></li></ul></li><li><a href="/后端开发/通用/lambda表达式.html" class="sidebar-link">JDK8新特性Lambda表达式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_0-自定义函数式接口" class="sidebar-link">0.自定义函数式接口</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_1-将接口用于方法参数" class="sidebar-link">1.将接口用于方法参数</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_2-jdk自带函数接口" class="sidebar-link">2.jdk自带函数接口</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_3-方法引用符" class="sidebar-link">3.方法引用符 ::</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_1-stream流创建操作" class="sidebar-link">1.Stream流创建操作</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_2-stream流中间操作" class="sidebar-link">2.Stream流中间操作</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_3-stream终止操作" class="sidebar-link">3.Stream终止操作</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_4-steam并行流" class="sidebar-link">4.Steam并行流</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/lambda表达式.html#_5-steam流收集器" class="sidebar-link">5.Steam流收集器</a></li></ul></li><li><a href="/后端开发/通用/RabbitMQ.html" class="active sidebar-link">RabbitMQ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端开发/通用/RabbitMQ.html#对比当下主流的消息队列和选择问题" class="sidebar-link">对比当下主流的消息队列和选择问题</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RabbitMQ.html#rabbit使用docker方式进行安装" class="sidebar-link">Rabbit使用docker方式进行安装</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RabbitMQ.html#搭建rabbitmq普通集群" class="sidebar-link">搭建RabbitMQ普通集群</a></li></ul></li><li><a href="/后端开发/通用/RocketMQ.html" class="sidebar-link">RocketMQ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#消息中间件常见概念和编程模型" class="sidebar-link">消息中间件常见概念和编程模型</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq概述" class="sidebar-link">RocketMQ概述</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq源码方式安装" class="sidebar-link">RocketMQ源码方式安装</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq源码方式安装控制台" class="sidebar-link">RocketMQ源码方式安装控制台</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq实战之发送消息" class="sidebar-link">RocketMQ实战之发送消息</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq实战之接收消息" class="sidebar-link">RocketMQ实战之接收消息</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq核心配置" class="sidebar-link">RocketMQ核心配置</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#消息常见发送状态" class="sidebar-link">消息常见发送状态</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#生产和消费消息重试及处理" class="sidebar-link">生产和消费消息重试及处理</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#rocketmq异步发送消息和回调" class="sidebar-link">RocketMQ异步发送消息和回调</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#oneway消息及多种场景对比" class="sidebar-link">OneWay消息及多种场景对比</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#延迟消息-电商应用场景" class="sidebar-link">延迟消息-电商应用场景</a></li><li class="sidebar-sub-header"><a href="/后端开发/通用/RocketMQ.html#生产者之messagequeueselector" class="sidebar-link">生产者之MessageQueueSelector</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-vpx-content content__default"><h1 id="rabbitmq"><a href="#rabbitmq" class="header-anchor">#</a> RabbitMQ</h1> <h2 id="对比当下主流的消息队列和选择问题"><a href="#对比当下主流的消息队列和选择问题" class="header-anchor">#</a> 对比当下主流的消息队列和选择问题</h2> <ul><li><p>ActiveMQ：http://activemq.apache.org/</p> <ul><li><p>Apache出品，历史悠久，支持多种语言的客户端和协议，支持多种语言Java, .NET, C++ 等</p></li> <li><p>基于JMS Provider的实现</p></li> <li><p>缺点：吞吐量不高，多队列的时候性能下降，存在消息丢失的情况，比较少大规模使用</p></li></ul></li> <li><p>Kafka：http://kafka.apache.org/</p> <ul><li><p>是由Apache软件基金会开发的一个开源流处理平台，由Scala和Java编写。Kafka是一种高吞吐量的分布式发布订阅消息系统，它可以处理大规模的网站中的所有动作流数据(网页浏览，搜索和其他用户的行动)，副本集机制，实现数据冗余，保障数据尽量不丢失；支持多个生产者和消费者</p></li> <li><p>类似MQ，功能较为简单，主要支持简单的MQ功能</p></li> <li><p>缺点：不支持批量和广播消息，运维难度大，文档比较少, 需要掌握Scala</p></li></ul></li> <li><p>RocketMQ：http://rocketmq.apache.org/</p> <ul><li>阿里开源的一款的消息中间件, 纯Java开发，具有高吞吐量、高可用性、适合大规模分布式系统应用的特点, 性能强劲(零拷贝技术)，支持海量堆积, 支持指定次数和时间间隔的失败消息重发,支持consumer端tag过滤、延迟消息等，在阿里内部进行大规模使用，适合在电商，互联网金融等领域</li> <li>基于JMS Provider的实现</li> <li>缺点：社区相对不活跃，更新比较快，纯java支持</li></ul></li> <li><p>RabbitMQ：http://www.rabbitmq.com/</p> <ul><li>是一个开源的AMQP实现，服务器端用Erlang语言编写，支持多种客户端，如：Python、Ruby、.NET、Java、C、用于在分布式系统中存储转发消息，在易用性、扩展性、高可用性等方面表现不错</li> <li>缺点：使用Erlang开发，阅读和修改源码难度大</li></ul></li></ul> <h2 id="rabbit使用docker方式进行安装"><a href="#rabbit使用docker方式进行安装" class="header-anchor">#</a> Rabbit使用docker方式进行安装</h2> <p>说明：使用源码的方式安装依赖多、且版本和维护相对复杂，需要erlang环境、版本也是有要求，因此不建议在<strong>本地</strong>或<strong>服务器</strong>使用<strong>源码</strong>的方式安装，因为使用RabbitMQ安装erlang环境完全没必要。推荐使用云服务器或虚拟机使用docker安装，可用使用阿里云按量付费，花费几个小时时间进行安装。</p> <ul><li>环境问题说明：Win7、Win8、Win10、Mac、虚拟机等等，可能存在兼容问题。务必使用CentOS 7 以上版本，64位系统！！！！</li></ul> <p>我这里使用阿里云抢占式实例购买了3台用于学习部署集群使用</p> <p><img src="https://xk857.com/typora/2021/05image-20210522190327685.png" alt="image-20210522190327685"></p> <h3 id="安装docker"><a href="#安装docker" class="header-anchor">#</a> 安装Docker</h3> <p>依次运行以下命令添加yum源</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum update
yum <span class="token function">install</span> epel-release -y
yum clean all
yum list
</code></pre></div><p>安装并运行Docker。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>yum <span class="token function">install</span> docker-io -y
systemctl start <span class="token function">docker</span>
</code></pre></div><p>检查安装结果。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> info
</code></pre></div><p>启动使用Docker</p> <div class="language-shell extra-class"><pre class="language-shell"><code>systemctl start <span class="token function">docker</span>     <span class="token comment">#运行Docker守护进程</span>
systemctl stop <span class="token function">docker</span>      <span class="token comment">#停止Docker守护进程</span>
systemctl restart <span class="token function">docker</span>   <span class="token comment">#重启Docker守护进程</span>
</code></pre></div><p>帮助文档：https://help.aliyun.com/document_detail/51853.html?spm=a2c4g.11186623.6.820.RaToNY</p> <h3 id="安装rabbitmq"><a href="#安装rabbitmq" class="header-anchor">#</a> 安装RabbitMQ</h3> <p>账号：admin 密码：password，部署后访问：ip:15672，注意把防火墙和阿里云/腾讯云安全组开放15672端口</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#拉取镜像</span>
<span class="token function">docker</span> pull rabbitmq:management

<span class="token comment">#第一台机子</span>
<span class="token function">docker</span> run -d --hostname rabbit_host1 --name xk857_rabbit -e <span class="token assign-left variable">RABBITMQ_DEFAULT_USER</span><span class="token operator">=</span>admin -e <span class="token assign-left variable">RABBITMQ_DEFAULT_PASS</span><span class="token operator">=</span>password -p <span class="token number">15672</span>:15672 -p <span class="token number">5672</span>:5672 rabbitmq:management
<span class="token comment">#第二台机器</span>
<span class="token function">docker</span> run -d --hostname rabbit_host2 --name xk857_rabbit -e <span class="token assign-left variable">RABBITMQ_DEFAULT_USER</span><span class="token operator">=</span>admin -e <span class="token assign-left variable">RABBITMQ_DEFAULT_PASS</span><span class="token operator">=</span>password -p <span class="token number">15672</span>:15672 -p <span class="token number">5672</span>:5672 rabbitmq:management
<span class="token comment">#第三台机器</span>
<span class="token function">docker</span> run -d --hostname rabbit_host3 --name xk857_rabbit -e <span class="token assign-left variable">RABBITMQ_DEFAULT_USER</span><span class="token operator">=</span>admin -e <span class="token assign-left variable">RABBITMQ_DEFAULT_PASS</span><span class="token operator">=</span>password -p <span class="token number">15672</span>:15672 -p <span class="token number">5672</span>:5672 rabbitmq:management


<span class="token comment">#介绍</span>
-d 以守护进程方式在后台运行
-p <span class="token number">15672</span>:15672 management 界面管理访问端口
-p <span class="token number">5672</span>:5672 amqp 访问端口
--name：指定容器名
--hostname：设定容器的主机名，它会被写到容器内的 /etc/hostname 和 /etc/hosts，作为容器主机IP的别名，并且将显示在容器的bash中

-e 参数
  RABBITMQ_DEFAULT_USER 用户名
  RABBITMQ_DEFAULT_PASS 密码
</code></pre></div><p>主要端口介绍：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">4369</span> erlang 发现口
<span class="token number">5672</span> client 端通信口
<span class="token number">15672</span> 管理界面 ui 端口
<span class="token number">25672</span> server 间内部通信口
</code></pre></div><ul><li>Linux服务器检查防火墙是否关闭</li> <li>云服务器检查网络安全组是否开放端口</li></ul> <div class="language- extra-class"><pre class="language-text"><code>CentOS 7 以上默认使用的是firewall作为防火墙
查看防火墙状态
firewall-cmd --state

停止firewall
systemctl stop firewalld.service

禁止firewall开机启动
systemctl disable firewalld.service
</code></pre></div><h2 id="搭建rabbitmq普通集群"><a href="#搭建rabbitmq普通集群" class="header-anchor">#</a> 搭建RabbitMQ普通集群</h2></div> <!----> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/后端开发/通用/lambda表达式.html" class="prev">
        JDK8新特性Lambda表达式
      </a></span> <span class="next"><a href="/后端开发/通用/RocketMQ.html">
        RocketMQ
      </a>
      →
    </span></p></div> <div class="page-footer"><ul class="inner"><li>Theme by <a href="https://gitee.com/qcyblm/vuepress-theme-vpx" title="本站主题" target="_blank" rel="noopener noreferrer">VPX</a></li> <li>Powered by <a href="https://www.vuepress.cn/" target="_blank" rel="noopener noreferrer">VuePress</a></li> <!----> <li>
      © 2020-2022
       cv大魔王 </li> <li><a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank" rel="noopener noreferrer"><!---->  皖ICP备20012269号-1
      </a></li> </ul></div> </main> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.207d8edd.js" defer></script><script src="/assets/js/2.02d677e7.js" defer></script><script src="/assets/js/7.4b00f606.js" defer></script>
  </body>
</html>
