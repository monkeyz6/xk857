(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{514:function(a,t,s){"use strict";s.r(t);var n=s(2),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("一个更易于构建云原生应用的动态服务发现、配置管理和服务管理平台。\n")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("官网：https://nacos.io/zh-cn/")])]),a._v(" "),t("li",[t("p",[a._v("下载管理：")]),a._v(" "),t("ul",[t("li",[a._v("https://download.fastgit.org/alibaba/nacos/releases/download/2.0.0-ALPHA.2/nacos-server-2.0.0-ALPHA.2.tar.gz")]),a._v(" "),t("li",[a._v("https://download.fastgit.org/alibaba/nacos/releases/download/2.0.0-ALPHA.2/nacos-server-2.0.0-ALPHA.2.zip")])])]),a._v(" "),t("li",[t("p",[a._v("Linux/Mac安装Nacos")]),a._v(" "),t("ul",[t("li",[a._v("解压安装包")]),a._v(" "),t("li",[a._v("进入bin目录")]),a._v(" "),t("li",[a._v("启动 sh startup.sh -m standalone")]),a._v(" "),t("li",[a._v("访问 localhost:8848/nacos")]),a._v(" "),t("li",[a._v("默认账号密码 nacos/nacos")]),a._v(" "),t("li",[a._v("关闭: sh shutdown.sh")])])])]),a._v(" "),t("h3",{attrs:{id:"_1-模块中添加依赖"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-模块中添加依赖"}},[a._v("#")]),a._v(" 1.模块中添加依赖")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!--添加nacos客户端--\x3e")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-discovery"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])])]),t("h3",{attrs:{id:"_2-视频微服务配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-视频微服务配置"}},[a._v("#")]),a._v(" 2.视频微服务配置")]),a._v(" "),t("div",{staticClass:"language-yml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" xk857"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("video"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("discovery")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos.xk857.com\n")])])]),t("h3",{attrs:{id:"_3-启动类增加注解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动类增加注解"}},[a._v("#")]),a._v(" 3.启动类增加注解")]),a._v(" "),t("blockquote",[t("p",[a._v("@EnableDiscoveryClient")])]),a._v(" "),t("h2",{attrs:{id:"简单实现服务调用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简单实现服务调用"}},[a._v("#")]),a._v(" 简单实现服务调用")]),a._v(" "),t("ol",[t("li",[a._v("获取"),t("code",[a._v("nacos")]),a._v("服务列表")])]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Autowired")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DiscoveryClient")]),a._v(" discoveryClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[a._v("获取服务")])]),a._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//获取指定服务的集合(实际中可能会有集群)")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ServiceInstance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" instances "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" discoveryClient"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getInstances")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"k857-order-service"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//这里只有一个，获取那一个服务就好")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ServiceInstance")]),a._v(" serviceInstance "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" instances"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])])]),t("h3",{attrs:{id:"ribbon负载均衡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ribbon负载均衡"}},[a._v("#")]),a._v(" Ribbon负载均衡")]),a._v(" "),t("ul",[t("li",[t("p",[a._v("软硬件角度负载均衡的种类")]),a._v(" "),t("ul",[t("li",[a._v("通过硬件来进行解决，常见的硬件有NetScaler、F5、Radware和Array等商用的负载均衡器，但比较昂贵的")]),a._v(" "),t("li",[a._v("通过软件来进行解决，常见的软件有LVS、Nginx等,它们是基于Linux系统并且开源的负载均衡策略")])])]),a._v(" "),t("li",[t("p",[a._v("常见的负载均衡策略（看组件的支持情况）")]),a._v(" "),t("ul",[t("li",[a._v("节点轮询\n"),t("ul",[t("li",[a._v("简介：每个请求按顺序分配到不同的后端服务器")])])]),a._v(" "),t("li",[a._v("weight 权重配置\n"),t("ul",[t("li",[a._v("简介：weight和访问比率成正比，数字越大，分配得到的流量越高")])])]),a._v(" "),t("li",[a._v("固定分发\n"),t("ul",[t("li",[a._v("简介：根据请求按访问ip的hash结果分配，这样每个用户就可以固定访问一个后端服务器")])])]),a._v(" "),t("li",[a._v("随机选择、最短响应时间等等")])])])]),a._v(" "),t("p",[t("strong",[a._v("AlibabaCloud集成Ribbon实现负载均衡")])]),a._v(" "),t("ul",[t("li",[a._v("什么是Ribbon Ribbon是一个客户端负载均衡工具，通过Spring Cloud封装，可以轻松和AlibabaCloud整合")]),a._v(" "),t("li",[a._v("订单服务增加@LoadBalanced 注解")])]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("@Bean\n@LoadBalanced\npublic RestTemplate restTemplate() {\n  return new RestTemplate();\n}\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);