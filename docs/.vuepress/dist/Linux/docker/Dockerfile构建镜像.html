<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dockerfile构建镜像 | 星空小屋</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://oss.xk857.com/images/20220808/3a23288316be4f1d9e29453ceba07eb4.png">
    <link href="https://cdn.jsdelivr.net/npm/@docsearch/css@3" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
    <meta name="description" content="技术类笔记，在往全栈的路上努力奋斗，主攻java，擅长微服务。前端方面熟悉vue3，ts，uniapp，原生安卓。对设计模式有所了解，正在恶补数据结构和算法">
    
    <link rel="preload" href="/assets/css/0.styles.c8bd9035.css" as="style"><link rel="preload" href="/assets/js/app.32abf263.js" as="script"><link rel="preload" href="/assets/js/4.a8f326f7.js" as="script"><link rel="preload" href="/assets/js/1.8aa3fbce.js" as="script"><link rel="preload" href="/assets/js/14.cc14b850.js" as="script"><link rel="prefetch" href="/assets/js/10.65564604.js"><link rel="prefetch" href="/assets/js/100.ae5f158c.js"><link rel="prefetch" href="/assets/js/101.a1b4f446.js"><link rel="prefetch" href="/assets/js/102.46ffff25.js"><link rel="prefetch" href="/assets/js/103.f803ae3a.js"><link rel="prefetch" href="/assets/js/104.2d60d8c5.js"><link rel="prefetch" href="/assets/js/105.2158da82.js"><link rel="prefetch" href="/assets/js/106.ee1de785.js"><link rel="prefetch" href="/assets/js/107.6a9dabca.js"><link rel="prefetch" href="/assets/js/108.9b6163a2.js"><link rel="prefetch" href="/assets/js/109.6a94e7c8.js"><link rel="prefetch" href="/assets/js/11.2b59d46b.js"><link rel="prefetch" href="/assets/js/110.a53dec7e.js"><link rel="prefetch" href="/assets/js/111.b1fd09a0.js"><link rel="prefetch" href="/assets/js/112.4c29ca10.js"><link rel="prefetch" href="/assets/js/113.2e63c85d.js"><link rel="prefetch" href="/assets/js/114.81fc796d.js"><link rel="prefetch" href="/assets/js/115.83068ad8.js"><link rel="prefetch" href="/assets/js/116.41d37a7c.js"><link rel="prefetch" href="/assets/js/117.260e302a.js"><link rel="prefetch" href="/assets/js/118.3edfbb7c.js"><link rel="prefetch" href="/assets/js/119.67e41fa5.js"><link rel="prefetch" href="/assets/js/12.15ac6f9a.js"><link rel="prefetch" href="/assets/js/120.d863f15e.js"><link rel="prefetch" href="/assets/js/121.682225d4.js"><link rel="prefetch" href="/assets/js/122.518bd417.js"><link rel="prefetch" href="/assets/js/123.16b160f0.js"><link rel="prefetch" href="/assets/js/124.d1b6d7e3.js"><link rel="prefetch" href="/assets/js/125.ad0ab959.js"><link rel="prefetch" href="/assets/js/126.44f28e9d.js"><link rel="prefetch" href="/assets/js/127.b08f656a.js"><link rel="prefetch" href="/assets/js/128.7eccfc7c.js"><link rel="prefetch" href="/assets/js/129.ee2770c0.js"><link rel="prefetch" href="/assets/js/13.afbf9205.js"><link rel="prefetch" href="/assets/js/130.b428b6ac.js"><link rel="prefetch" href="/assets/js/131.e2b5454a.js"><link rel="prefetch" href="/assets/js/132.0d11d220.js"><link rel="prefetch" href="/assets/js/133.a92320f6.js"><link rel="prefetch" href="/assets/js/134.77689a05.js"><link rel="prefetch" href="/assets/js/135.f19192ac.js"><link rel="prefetch" href="/assets/js/136.69f3731f.js"><link rel="prefetch" href="/assets/js/137.af431c1c.js"><link rel="prefetch" href="/assets/js/138.4bda5ddc.js"><link rel="prefetch" href="/assets/js/139.65cf4900.js"><link rel="prefetch" href="/assets/js/140.af40cfdd.js"><link rel="prefetch" href="/assets/js/141.1c873420.js"><link rel="prefetch" href="/assets/js/142.9d0cb497.js"><link rel="prefetch" href="/assets/js/143.c1ed9e0d.js"><link rel="prefetch" href="/assets/js/144.b40fdc84.js"><link rel="prefetch" href="/assets/js/145.6311cbbc.js"><link rel="prefetch" href="/assets/js/146.96e10f75.js"><link rel="prefetch" href="/assets/js/147.ce044a7c.js"><link rel="prefetch" href="/assets/js/148.198134d5.js"><link rel="prefetch" href="/assets/js/149.f7495153.js"><link rel="prefetch" href="/assets/js/15.3e4e11e1.js"><link rel="prefetch" href="/assets/js/150.4aee5573.js"><link rel="prefetch" href="/assets/js/151.d779e2ec.js"><link rel="prefetch" href="/assets/js/152.046c3531.js"><link rel="prefetch" href="/assets/js/153.1aa65948.js"><link rel="prefetch" href="/assets/js/154.9848a433.js"><link rel="prefetch" href="/assets/js/155.a27a86a3.js"><link rel="prefetch" href="/assets/js/156.2026a86b.js"><link rel="prefetch" href="/assets/js/157.1998b919.js"><link rel="prefetch" href="/assets/js/158.d68ef0f9.js"><link rel="prefetch" href="/assets/js/159.54cdc4e3.js"><link rel="prefetch" href="/assets/js/16.5a8becbe.js"><link rel="prefetch" href="/assets/js/17.9960dcda.js"><link rel="prefetch" href="/assets/js/18.4ffc97d3.js"><link rel="prefetch" href="/assets/js/19.11f73c5a.js"><link rel="prefetch" href="/assets/js/20.5a151ea7.js"><link rel="prefetch" href="/assets/js/21.0c58ba2f.js"><link rel="prefetch" href="/assets/js/22.4b594cb6.js"><link rel="prefetch" href="/assets/js/23.636121df.js"><link rel="prefetch" href="/assets/js/24.0d80fed7.js"><link rel="prefetch" href="/assets/js/25.2b43543c.js"><link rel="prefetch" href="/assets/js/26.64056c00.js"><link rel="prefetch" href="/assets/js/27.47276271.js"><link rel="prefetch" href="/assets/js/28.ca9f489a.js"><link rel="prefetch" href="/assets/js/29.ad865df1.js"><link rel="prefetch" href="/assets/js/30.878e69f5.js"><link rel="prefetch" href="/assets/js/31.fb0cd4b9.js"><link rel="prefetch" href="/assets/js/32.7c79b7bf.js"><link rel="prefetch" href="/assets/js/33.f3499b6d.js"><link rel="prefetch" href="/assets/js/34.ce0c2b95.js"><link rel="prefetch" href="/assets/js/35.36019291.js"><link rel="prefetch" href="/assets/js/36.a65bed7c.js"><link rel="prefetch" href="/assets/js/37.5c38f4ca.js"><link rel="prefetch" href="/assets/js/38.8bcc6ba7.js"><link rel="prefetch" href="/assets/js/39.5b6c9235.js"><link rel="prefetch" href="/assets/js/40.02f6db4d.js"><link rel="prefetch" href="/assets/js/41.a873a567.js"><link rel="prefetch" href="/assets/js/42.739faa76.js"><link rel="prefetch" href="/assets/js/43.65e7f1cc.js"><link rel="prefetch" href="/assets/js/44.7eec7678.js"><link rel="prefetch" href="/assets/js/45.349461a6.js"><link rel="prefetch" href="/assets/js/46.50523e3d.js"><link rel="prefetch" href="/assets/js/47.3fb7fd99.js"><link rel="prefetch" href="/assets/js/48.7f2f722b.js"><link rel="prefetch" href="/assets/js/49.f7c82d85.js"><link rel="prefetch" href="/assets/js/5.b7192139.js"><link rel="prefetch" href="/assets/js/50.7ea748df.js"><link rel="prefetch" href="/assets/js/51.cbb2ac45.js"><link rel="prefetch" href="/assets/js/52.e6aa2035.js"><link rel="prefetch" href="/assets/js/53.1e269534.js"><link rel="prefetch" href="/assets/js/54.7615c9ab.js"><link rel="prefetch" href="/assets/js/55.665d499e.js"><link rel="prefetch" href="/assets/js/56.545e8593.js"><link rel="prefetch" href="/assets/js/57.1bd6eff2.js"><link rel="prefetch" href="/assets/js/58.d7247cc4.js"><link rel="prefetch" href="/assets/js/59.c066b39f.js"><link rel="prefetch" href="/assets/js/6.59c468a4.js"><link rel="prefetch" href="/assets/js/60.eb7d20e5.js"><link rel="prefetch" href="/assets/js/61.fd1abca7.js"><link rel="prefetch" href="/assets/js/62.b20c00e1.js"><link rel="prefetch" href="/assets/js/63.329dbb3f.js"><link rel="prefetch" href="/assets/js/64.fef601a1.js"><link rel="prefetch" href="/assets/js/65.3cb5dec1.js"><link rel="prefetch" href="/assets/js/66.eca04818.js"><link rel="prefetch" href="/assets/js/67.dd65225a.js"><link rel="prefetch" href="/assets/js/68.a0618f84.js"><link rel="prefetch" href="/assets/js/69.e8b6d5d7.js"><link rel="prefetch" href="/assets/js/7.a7dceda1.js"><link rel="prefetch" href="/assets/js/70.20891d58.js"><link rel="prefetch" href="/assets/js/71.ab01f68f.js"><link rel="prefetch" href="/assets/js/72.c6aa57f8.js"><link rel="prefetch" href="/assets/js/73.4a4497a9.js"><link rel="prefetch" href="/assets/js/74.f2d4823d.js"><link rel="prefetch" href="/assets/js/75.94a4057e.js"><link rel="prefetch" href="/assets/js/76.98778307.js"><link rel="prefetch" href="/assets/js/77.4a0aee77.js"><link rel="prefetch" href="/assets/js/78.cc1c4111.js"><link rel="prefetch" href="/assets/js/79.ddad1a6d.js"><link rel="prefetch" href="/assets/js/8.9788873e.js"><link rel="prefetch" href="/assets/js/80.46c48d76.js"><link rel="prefetch" href="/assets/js/81.7208457c.js"><link rel="prefetch" href="/assets/js/82.b3347c15.js"><link rel="prefetch" href="/assets/js/83.834f2562.js"><link rel="prefetch" href="/assets/js/84.33a1bbf5.js"><link rel="prefetch" href="/assets/js/85.3dbc3be5.js"><link rel="prefetch" href="/assets/js/86.5f4529dd.js"><link rel="prefetch" href="/assets/js/87.ee3f9422.js"><link rel="prefetch" href="/assets/js/88.01e542ef.js"><link rel="prefetch" href="/assets/js/89.426ae2c1.js"><link rel="prefetch" href="/assets/js/9.dd26be22.js"><link rel="prefetch" href="/assets/js/90.44af0eb3.js"><link rel="prefetch" href="/assets/js/91.6a4dbff7.js"><link rel="prefetch" href="/assets/js/92.1e57d1f6.js"><link rel="prefetch" href="/assets/js/93.b6915234.js"><link rel="prefetch" href="/assets/js/94.bca66892.js"><link rel="prefetch" href="/assets/js/95.0044daf1.js"><link rel="prefetch" href="/assets/js/96.7d0f0e76.js"><link rel="prefetch" href="/assets/js/97.f1b91601.js"><link rel="prefetch" href="/assets/js/98.051327b9.js"><link rel="prefetch" href="/assets/js/99.5c8cd705.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.11f69535.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c8bd9035.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-5bb33761><div data-v-5bb33761><div class="password-shadow password-wrapper-out" style="display:none;" data-v-59e6cb88 data-v-5bb33761 data-v-5bb33761><h3 class="title" data-v-59e6cb88>星空小屋</h3> <p class="description" data-v-59e6cb88>技术类笔记，在往全栈的路上努力奋斗，主攻java，擅长微服务。前端方面熟悉vue3，ts，uniapp，原生安卓。对设计模式有所了解，正在恶补数据结构和算法</p> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>cv大魔王</span>
          
        <span data-v-59e6cb88>2020 - </span>
        2022
      </a></span></div></div> <div class="hide" data-v-5bb33761><header class="navbar" data-v-5bb33761><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://oss.xk857.com/images/20220808/LGGO_MINI.png" alt="星空小屋" class="logo"> <span class="site-name">星空小屋</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-JavaCorefenxigongju"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端开发/常用框架/MybatisPlus/SpringBoot整合MybatisPlus.html" class="nav-link"><i class="iconfont icon-shujuku"></i>
  常用框架锦集
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/java/java高效编程常用技术优化手段/资源关闭优化方案.html" class="nav-link"><i class="iconfont icon-java"></i>
  java开发技巧
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/redis专栏/高阶使用技巧/Redis概述及基本使用.html" class="nav-link"><i class="iconfont icon-Redis"></i>
  Redis专栏
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/中间件/RabbitMQ/主流的消息队列和选择问题.html" class="nav-link"><i class="iconfont icon-xiaoxiduilie"></i>
  消息队列专栏
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/第三方支付/微信支付V3/微信支付准备工作.html" class="nav-link"><i class="iconfont icon-weixinzhifu"></i>
  第三方支付
</a></li><li class="dropdown-item"><!----> <a href="/Spring专栏/SpringBoot使用技巧/面向切面编程AOP.html" class="nav-link"><i class="iconfont icon-Leaf"></i>
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/微服务/SpringCloudAlibaba/分布式架构理论.html" class="nav-link"><i class="iconfont icon-mseweifuwuyinqing"></i>
  SpringCloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-codepen-circle-fill"></i>
      前端开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端开发/vue/Vue3核心开发手册/使用Vite创建vue3项目.html" class="nav-link"><i class="iconfont icon-Vue"></i>
  Vue框架
</a></li><li class="dropdown-item"><!----> <a href="/前端开发/前端基础/css/CSS设计模式.html" class="nav-link"><i class="iconfont icon-sheji-xianxing"></i>
  基础扩展
</a></li></ul></div></div><div class="nav-item"><a href="/数据库/新零售行业数据库设计/" class="nav-link"><i class="iconfont icon-shujuku1"></i>
  数据库
</a></div><div class="nav-item"><a href="/插件开发/IDEA插件开发常用API/插件开发之创建菜单.html" class="nav-link"><i class="iconfont icon-menu_cjgl"></i>
  插件开发
</a></div><div class="nav-item"><a href="/Linux/Centos7/Linux常用命令.html" class="nav-link"><i class="iconfont icon-centos"></i>
  Linux
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-f-about"></i>
  关于
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-5bb33761></div> <aside class="sidebar" data-v-5bb33761><div class="personal-info-wrapper" data-v-1fad0c41 data-v-5bb33761><img src="https://student-xk857.oss-cn-shanghai.aliyuncs.com/typora/2022/07/image-20220731204655849.png" alt="author-avatar" class="personal-img" data-v-1fad0c41> <h3 class="name" data-v-1fad0c41>
    cv大魔王
  </h3> <div class="num" data-v-1fad0c41><div data-v-1fad0c41><h3 data-v-1fad0c41>148</h3> <h6 data-v-1fad0c41>Articles</h6></div> <div data-v-1fad0c41><h3 data-v-1fad0c41>28</h3> <h6 data-v-1fad0c41>Tags</h6></div></div> <ul class="social-links" data-v-1fad0c41></ul> <hr data-v-1fad0c41></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-JavaCorefenxigongju"></i>
      Java
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/后端开发/常用框架/MybatisPlus/SpringBoot整合MybatisPlus.html" class="nav-link"><i class="iconfont icon-shujuku"></i>
  常用框架锦集
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/java/java高效编程常用技术优化手段/资源关闭优化方案.html" class="nav-link"><i class="iconfont icon-java"></i>
  java开发技巧
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/redis专栏/高阶使用技巧/Redis概述及基本使用.html" class="nav-link"><i class="iconfont icon-Redis"></i>
  Redis专栏
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/中间件/RabbitMQ/主流的消息队列和选择问题.html" class="nav-link"><i class="iconfont icon-xiaoxiduilie"></i>
  消息队列专栏
</a></li><li class="dropdown-item"><!----> <a href="/后端开发/第三方支付/微信支付V3/微信支付准备工作.html" class="nav-link"><i class="iconfont icon-weixinzhifu"></i>
  第三方支付
</a></li><li class="dropdown-item"><!----> <a href="/Spring专栏/SpringBoot使用技巧/面向切面编程AOP.html" class="nav-link"><i class="iconfont icon-Leaf"></i>
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/微服务/SpringCloudAlibaba/分布式架构理论.html" class="nav-link"><i class="iconfont icon-mseweifuwuyinqing"></i>
  SpringCloud
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont icon-codepen-circle-fill"></i>
      前端开发
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/前端开发/vue/Vue3核心开发手册/使用Vite创建vue3项目.html" class="nav-link"><i class="iconfont icon-Vue"></i>
  Vue框架
</a></li><li class="dropdown-item"><!----> <a href="/前端开发/前端基础/css/CSS设计模式.html" class="nav-link"><i class="iconfont icon-sheji-xianxing"></i>
  基础扩展
</a></li></ul></div></div><div class="nav-item"><a href="/数据库/新零售行业数据库设计/" class="nav-link"><i class="iconfont icon-shujuku1"></i>
  数据库
</a></div><div class="nav-item"><a href="/插件开发/IDEA插件开发常用API/插件开发之创建菜单.html" class="nav-link"><i class="iconfont icon-menu_cjgl"></i>
  插件开发
</a></div><div class="nav-item"><a href="/Linux/Centos7/Linux常用命令.html" class="nav-link"><i class="iconfont icon-centos"></i>
  Linux
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont icon-f-about"></i>
  关于
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Centos7系统概述与操作命令</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux/Centos7/Linux常用命令.html" class="sidebar-link">Linux常用命令</a></li><li><a href="/Linux/Centos7/文件列表的详细信息.html" class="sidebar-link">文件列表的详细信息</a></li><li><a href="/Linux/Centos7/vim编辑器使用指南.html" class="sidebar-link">vim编辑器使用指南</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>容器化运维部署之Docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux/docker/Docker安装与环境安装.html" class="sidebar-link">Docker安装与环境安装</a></li><li><a href="/Linux/docker/Docker常用命令合集.html" class="sidebar-link">Docker常用命令合集</a></li><li><a href="/Linux/docker/容器的复制与挂载.html" class="sidebar-link">容器的复制与挂载</a></li><li><a href="/Linux/docker/Dockerfile构建镜像.html" class="active sidebar-link">Dockerfile构建镜像</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Shell编程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux/shell/Shell编程入门与基础语法.html" class="sidebar-link">Shell编程入门与基础语法</a></li><li><a href="/Linux/shell/Shell输出语句与参数传递.html" class="sidebar-link">Shell输出语句与参数传递</a></li><li><a href="/Linux/shell/Shell中的运算符与文件检测.html" class="sidebar-link">Shell中的运算符与文件检测</a></li><li><a href="/Linux/shell/流程控制、循环语句.html" class="sidebar-link">流程控制、循环语句</a></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-59e6cb88 data-v-5bb33761><h3 class="title" data-v-59e6cb88>Dockerfile构建镜像</h3> <!----> <label id="box" class="inputBox" data-v-59e6cb88><input type="password" value="" data-v-59e6cb88> <span data-v-59e6cb88>Konck! Knock!</span> <button data-v-59e6cb88>OK</button></label> <div class="footer" data-v-59e6cb88><span data-v-59e6cb88><i class="iconfont reco-theme" data-v-59e6cb88></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-59e6cb88>vuePress-theme-reco</a></span> <span data-v-59e6cb88><i class="iconfont reco-copyright" data-v-59e6cb88></i> <a data-v-59e6cb88><span data-v-59e6cb88>cv大魔王</span>
          
        <span data-v-59e6cb88>2020 - </span>
        2022
      </a></span></div></div> <div data-v-5bb33761><div data-v-5bb33761><main class="page" style="padding-right:0;"><section style="display:;"><div class="page-title"><h1 class="title">Dockerfile构建镜像</h1> <div data-v-8a445198><i class="iconfont reco-account" data-v-8a445198><span data-v-8a445198>cv大魔王</span></i> <i class="iconfont reco-date" data-v-8a445198><span data-v-8a445198>11/10/2020</span></i> <i class="iconfont reco-eye" data-v-8a445198><span id="/Linux/docker/Dockerfile%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-8a445198><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="tags iconfont reco-tag" data-v-8a445198><span class="tag-item" data-v-8a445198>Linux</span><span class="tag-item" data-v-8a445198>docker</span></i></div></div> <div class="theme-reco-content content__default"><p>Dockerfile 是一个文本文件，其内包含了一条条的指令(Instruction)，用于构建镜像。每一条指令构建一层镜像，因此每一条指令的内容，就是描述该层镜像应当如何构建。

dockerHub官网：<a href="https://hub.docker.com/" target="_blank" rel="noopener noreferrer">Docker Hub<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
常用命令如下：</p> <ul><li><strong>FROM</strong>：基于哪个镜像</li> <li><strong>MAINTAINER</strong>：注明作者</li> <li><strong>COPY</strong>：复制文件进入镜像（只能用相对路径，不能用绝对路径）</li> <li><strong>ADD</strong>：复制文件进入镜像（假如文件是.tar.gz文件会解压）</li> <li><strong>WORKDIR</strong>：指定工作目录，假如路径不存在会创建路径</li> <li><strong>ENV</strong>：设置环境变量</li> <li><strong>EXPOSE</strong>：暴露容器端口</li> <li><strong>RUN</strong>：在构建镜像的时候执行，作用于镜像层面</li> <li><strong>ENTRYPOINT</strong>：在容器启动的时候执行，作用于容器层，dockerfile里有多条时只允许执行最后一条</li> <li><strong>CMD</strong>：在容器启动的时候执行，作用于容器层，
<ul><li>dockerfile里有多条时只允许执行最后一条。</li> <li>容器启动后执行默认的命令或者参数，允许被修改</li></ul></li> <li>命令格式：
<ul><li>shell命令格式：RUN yum install -y net-tools</li> <li>exec命令格式：RUN [ &quot;yum&quot;,&quot;install&quot; ,&quot;-y&quot; ,&quot;net-tools&quot;]</li></ul></li></ul> <h2 id="_1-基础镜像的选择"><a href="#_1-基础镜像的选择" class="header-anchor">#</a> 1.基础镜像的选择</h2> <p>基本原则如下</p> <ul><li>官方镜像优于非官方的镜像，如果没有官方镜像，则尽量选择Dockerfile开源的</li> <li>固定版本tag而不是每次都使用latest <code>FROM nginx:1.21.0-alpine</code></li> <li>尽量选择体积小的镜像</li> <li>如何区分官方镜像？ —— 搜索后的前几个（verified content下的都是）</li></ul> <p>实践练习：</p> <p>假如我们有一个 <code>index.html</code> 文件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello Docker<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>准备一个Dockerfile</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> nginx:1.21.0-alpine</span>

<span class="token instruction"><span class="token keyword">ADD</span> index.html /usr/share/nginx/html/index.html</span>
</code></pre></div><p>构建命令</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> image build -t 镜像名称
</code></pre></div><h2 id="_2-通过run执行命令"><a href="#_2-通过run执行命令" class="header-anchor">#</a> 2.通过RUN执行命令</h2> <p><code>RUN</code> 主要用于在Image里执行指令，比如安装软件，下载文件等。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">apt-get</span> update
<span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">wget</span>
<span class="token function">wget</span> https://github.com/ipinfo/cli/releases/download/ipinfo-2.0.1/ipinfo_2.0.1_linux_amd64.tar.gz
<span class="token function">tar</span> zxf ipinfo_2.0.1_linux_amd64.tar.gz
<span class="token function">mv</span> ipinfo_2.0.1_linux_amd64 /usr/bin/ipinfo
<span class="token function">rm</span> -rf ipinfo_2.0.1_linux_amd64.tar.gz
</code></pre></div><h3 id="_2-1-举例说明"><a href="#_2-1-举例说明" class="header-anchor">#</a> 2.1 举例说明</h3> <p>说明：下面这种写法是有问题的，虽然可以执行，但是每一行的RUN命令都会产生一层image layer, 导致镜像的臃肿。</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get install -y wget</span>
<span class="token instruction"><span class="token keyword">RUN</span> wget https://github.com/ipinfo/cli/releases/download/ipinfo-2.0.1/ipinfo_2.0.1_linux_amd64.tar.gz</span>
<span class="token instruction"><span class="token keyword">RUN</span> tar zxf ipinfo_2.0.1_linux_amd64.tar.gz</span>
<span class="token instruction"><span class="token keyword">RUN</span> mv ipinfo_2.0.1_linux_amd64 /usr/bin/ipinfo</span>
<span class="token instruction"><span class="token keyword">RUN</span> rm -rf ipinfo_2.0.1_linux_amd64.tar.gz</span>
</code></pre></div><h3 id="_2-2-构建命令改进"><a href="#_2-2-构建命令改进" class="header-anchor">#</a> 2.2 构建命令改进</h3> <div class="language- extra-class"><pre class="language-text"><code>FROM ubuntu:21.04
RUN apt-get update &amp;&amp; \
    apt-get install -y wget &amp;&amp; \
    wget https://github.com/ipinfo/cli/releases/download/ipinfo-2.0.1/ipinfo_2.0.1_linux_amd64.tar.gz &amp;&amp; \
    tar zxf ipinfo_2.0.1_linux_amd64.tar.gz &amp;&amp; \
    mv ipinfo_2.0.1_linux_amd64 /usr/bin/ipinfo &amp;&amp; \
    rm -rf ipinfo_2.0.1_linux_amd64.tar.gz
</code></pre></div><h2 id="_3-文件复制和目录操作"><a href="#_3-文件复制和目录操作" class="header-anchor">#</a> 3.文件复制和目录操作</h2> <p>往镜像里复制文件有两种方式，<code>COPY</code> 和 <code>ADD</code> 都可以把local的一个文件复制到镜像里，如果目标目录不存在，则会自动创建</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> python:3.9.5-alpine3.13</span>
<span class="token instruction"><span class="token keyword">COPY</span> hello.py /app/hello.py</span>
</code></pre></div><p>比如把本地的 hello.py 复制到 /app 目录下。 /app这个folder不存在，则会自动创建</p> <h3 id="_3-1-复制压缩文件"><a href="#_3-1-复制压缩文件" class="header-anchor">#</a> 3.1 复制压缩文件</h3> <p><code>ADD</code> 比 COPY高级一点的地方就是，如果复制的是一个gzip等压缩文件时，ADD会帮助我们自动去解压缩文件。</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> python:3.9.5-alpine3.13</span>
<span class="token instruction"><span class="token keyword">ADD</span> hello.tar.gz /app/</span>
</code></pre></div><p>因此在 COPY 和 ADD 指令中选择的时候，可以遵循这样的原则，所有的文件复制均使用 COPY 指令，仅在需要自动解压缩的场合使用 ADD。</p> <h2 id="_4-构建参数和环境变量"><a href="#_4-构建参数和环境变量" class="header-anchor">#</a> 4. 构建参数和环境变量</h2> <p><code>ARG</code> 和 <code>ENV</code> 是经常容易被混淆的两个Dockerfile的语法，都可以用来设置一个“变量”。 但实际上两者有很多的不同。</p> <p>首先看使用前的镜像构建，注意2.0.1</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; <span class="token operator">\</span>
    apt-get install -y wget &amp;&amp; <span class="token operator">\</span>
    wget https://github.com/ipinfo/cli/releases/download/ipinfo-2.0.1/ipinfo_2.0.1_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    tar zxf ipinfo_2.0.1_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    mv ipinfo_2.0.1_linux_amd64 /usr/bin/ipinfo &amp;&amp; <span class="token operator">\</span>
    rm -rf ipinfo_2.0.1_linux_amd64.tar.gz</span>
</code></pre></div><h3 id="_4-1-env方式"><a href="#_4-1-env方式" class="header-anchor">#</a> 4.1 ENV方式</h3> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">ENV</span> VERSION=2.0.1</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; <span class="token operator">\</span>
    apt-get install -y wget &amp;&amp; <span class="token operator">\</span>
    wget https://github.com/ipinfo/cli/releases/download/ipinfo-<span class="token variable">${VERSION}</span>/ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    tar zxf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    mv ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64 /usr/bin/ipinfo &amp;&amp; <span class="token operator">\</span>
    rm -rf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz</span>
</code></pre></div><h3 id="_4-2-arg方式"><a href="#_4-2-arg方式" class="header-anchor">#</a> 4.2 ARG方式</h3> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">ARG</span> VERSION=2.0.1</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; <span class="token operator">\</span>
    apt-get install -y wget &amp;&amp; <span class="token operator">\</span>
    wget https://github.com/ipinfo/cli/releases/download/ipinfo-<span class="token variable">${VERSION}</span>/ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    tar zxf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    mv ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64 /usr/bin/ipinfo &amp;&amp; <span class="token operator">\</span>
    rm -rf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz</span>
</code></pre></div><h3 id="_4-3-区别"><a href="#_4-3-区别" class="header-anchor">#</a> 4.3 区别</h3> <ul><li>ARG：构建镜像后，遍历不存在</li> <li>ENV：构建镜像后，存在系统变量中，进入镜像容器中，输入env可以看到环境变量</li></ul> <p><img src="https://dockertips.readthedocs.io/en/latest/_images/docker_environment_build_args.png" alt="img"></p> <h2 id="_5-容器启动命令-cmd"><a href="#_5-容器启动命令-cmd" class="header-anchor">#</a> 5.容器启动命令 CMD</h2> <p>CMD可以用来设置容器启动时默认会执行的命令。</p> <ul><li>容器启动时默认执行的命令</li> <li>如果docker container run启动容器时指定了其它命令，则CMD命令会被忽略</li> <li>如果定义了多个CMD，只有最后一个会被执行。</li> <li>容器启动后执行默认的命令或者参数，允许被修改</li></ul> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">ENV</span> VERSION=2.0.1</span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; <span class="token operator">\</span>
    apt-get install -y wget &amp;&amp; <span class="token operator">\</span>
    wget https://github.com/ipinfo/cli/releases/download/ipinfo-<span class="token variable">${VERSION}</span>/ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    tar zxf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz &amp;&amp; <span class="token operator">\</span>
    mv ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64 /usr/bin/ipinfo &amp;&amp; <span class="token operator">\</span>
    rm -rf ipinfo_<span class="token variable">${VERSION}</span>_linux_amd64.tar.gz</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;echo&quot;</span>,<span class="token string">&quot;containe1r&quot;</span>,<span class="token string">&quot;starting...&quot;</span>]</span>
</code></pre></div><h2 id="_6-容器启动命令-entrypoint"><a href="#_6-容器启动命令-entrypoint" class="header-anchor">#</a> 6.容器启动命令 ENTRYPOINT</h2> <p>ENTRYPOINT 也可以设置容器启动时要执行的命令，但是和CMD是有区别的。</p> <ul><li><code>CMD</code> 设置的命令，可以在docker container run 时传入其它命令，覆盖掉 <code>CMD</code> 的命令，但是 <code>ENTRYPOINT</code> 所设置的命令是一定会被执行的。</li> <li><code>ENTRYPOINT</code> 和 <code>CMD</code> 可以联合使用，<code>ENTRYPOINT</code> 设置执行的命令，CMD传递参数</li></ul> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> centos:7</span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;images building!&quot;</span></span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;echo&quot;</span>,<span class="token string">&quot;container&quot;</span>,<span class="token string">&quot;starting...&quot;</span>]</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;echo&quot;</span>,<span class="token string">&quot;container&quot;</span>,<span class="token string">&quot;starting ！！！&quot;</span>]</span>
</code></pre></div><p>运行举例：同样的命令，如果使用<code>RUN</code>, <code>echo &quot;hello world&quot;</code> 会将其覆盖，但是使用<code>ENTRYPOINT</code>则不会受到影响</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> container run -it --rm demo-cmd <span class="token builtin class-name">echo</span> <span class="token string">&quot;hello world&quot;</span>
</code></pre></div><h2 id="_7-shell-格式和-exec-格式"><a href="#_7-shell-格式和-exec-格式" class="header-anchor">#</a> 7.Shell 格式和 Exec 格式</h2> <h3 id="_7-1-shell格式"><a href="#_7-1-shell格式" class="header-anchor">#</a> 7.1 Shell格式</h3> <div class="language- extra-class"><pre class="language-text"><code>CMD echo &quot;hello docker&quot;
ENTRYPOINT echo &quot;hello docker&quot;
</code></pre></div><h3 id="_7-2-exec格式"><a href="#_7-2-exec格式" class="header-anchor">#</a> 7.2 Exec格式</h3> <p>以可执行命令的方式</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;hello docker&quot;</span>]</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;hello docker&quot;</span>]</span>
</code></pre></div><p>注意shell脚本的问题</p> <div class="language-shell extra-class"><pre class="language-shell"><code>FROM ubuntu:21.04
ENV <span class="token assign-left variable">NAME</span><span class="token operator">=</span>docker
CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;hello <span class="token variable">$NAME</span>&quot;</span>
</code></pre></div><p>假如我们要把上面的CMD改成Exec格式，下面这样改是不行的, 大家可以试试。</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">ENV</span> NAME=docker</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;echo&quot;</span>, <span class="token string">&quot;hello $NAME&quot;</span>]</span>
</code></pre></div><p>它会打印出 <code>hello $NAME</code> , 而不是 <code>hello docker</code> ,那么需要怎么写呢？ 我们需要以shell脚本的方式去执行</p> <div class="language-dockerfile extra-class"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> ubuntu:21.04</span>
<span class="token instruction"><span class="token keyword">ENV</span> NAME=docker</span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;sh&quot;</span>, <span class="token string">&quot;-c&quot;</span>, <span class="token string">&quot;echo hello $NAME&quot;</span>]</span>
</code></pre></div></div></section> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">17 小时前</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev"><a href="/Linux/docker/容器的复制与挂载.html" class="prev">
          容器的复制与挂载
        </a></span> <span class="next"><a href="/Linux/shell/Shell编程入门与基础语法.html">
          Shell编程入门与基础语法
        </a></span></p></div> <div class="comments-wrapper"><!----></div> <ul class="side-bar sub-sidebar-wrapper" style="width:0;" data-v-ac050c62></ul></main></div> <!----></div></div></div></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.32abf263.js" defer></script><script src="/assets/js/4.a8f326f7.js" defer></script><script src="/assets/js/1.8aa3fbce.js" defer></script><script src="/assets/js/14.cc14b850.js" defer></script>
  </body>
</html>
